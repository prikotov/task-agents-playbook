# üß© –ü–µ—Å–æ—á–Ω–∏—Ü—ã (Sandbox Environment)

## TL;DR

–ü–µ—Å–æ—á–Ω–∏—Ü—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ **TasK** (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∞–≥–µ–Ω—Ç–æ–≤, –≤–µ—Ç–æ–∫ –∏–ª–∏
—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã—Ö —Ñ–∏—á).  
–ö–∞–∂–¥–∞—è –ø–µ—Å–æ—á–Ω–∏—Ü–∞ ‚Äî —ç—Ç–æ **–æ—Ç–¥–µ–ª—å–Ω—ã–π `git clone`** —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è —Å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π –ë–î, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π –∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏, –¥–æ—Å—Ç—É–ø–Ω–∞—è
–ø–æ –ø–æ–¥–¥–æ–º–µ–Ω—É `testN.task.localhost`.

---

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç                            | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                       | –î–µ—Ç–∞–ª–∏                                                                                                                              |
|--------------------------------------|----------------------------------|-------------------------------------------------------------------------------------------------------------------------------------|
| **Git (clone)**                      | –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∫–æ–ø–∏—è –ø—Ä–æ–µ–∫—Ç–∞      | –ö–∞–∂–¥–∞—è –ø–µ—Å–æ—á–Ω–∏—Ü–∞ –∫–ª–æ–Ω–∏—Ä—É–µ—Ç—Å—è –∏–∑ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è TasK:<br>`git clone ~/PhpstormProjects/TasK ~/PhpstormProjects/Sandbox/testN` |
| **Podman + podman-compose**          | –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è –∏ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è    | –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –±–µ–∑ root-–¥–µ–º–æ–Ω–∞:<br>`podman-compose -f docker-compose.sandbox.yml up --build`                                    |
| **FrankenPHP (php8.4-alpine)**       | Web-—Å–µ—Ä–≤–µ—Ä –∏ PHP-runtime         | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (`app`); –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç Symfony Runtime –∏ HTTP/2.                                               |
| **Symfony 7.3 / PHP 8.4**            | –û—Å–Ω–æ–≤–Ω–æ–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫               | –ö–∞–∂–¥–∞—è –ø–µ—Å–æ—á–Ω–∏—Ü–∞ –∏–º–µ–µ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ (`.env`, `var/`, –∫–µ—à, –º–∏–≥—Ä–∞—Ü–∏–∏).                                                       |
| **PostgreSQL 17**                    | –•—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö                 | –î–ª—è –ø–µ—Å–æ—á–Ω–∏—Ü –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–±—â–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ë–î –∏–ª–∏ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ë–î (`DATABASE_URL`).                                                 |
| **Traefik v3.1**                     | –†–µ–≤–µ—Ä—Å-–ø—Ä–æ–∫—Å–∏ –∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è    | –£–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ–¥–¥–æ–º–µ–Ω–∞–º–∏ `*.task.localhost`, –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç HTTPS –∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫—É.                                                        |
| **mkcert**                           | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ | –°–æ–∑–¥–∞—ë—Ç wildcard-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã `task-wc-cert.pem` / `task-wc-key.pem` –¥–ª—è Traefik.                                                    |
| **TLS-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (`dynamic.yml`)** | –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Traefik TLS            | –£–∫–∞–∑—ã–≤–∞–µ—Ç —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏ wildcard-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã.                                                                          |
| **bin-—Å–∫—Ä–∏–ø—Ç—ã**                      | –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è                    | –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ –∑–∞–ø—É—Å–∫–∞ –ø–µ—Å–æ—á–Ω–∏—Ü:<br>`bin/traefik-check`, `bin/sandbox-up`, `bin/sandbox-down`.                              |
| **Healthcheck**                      | –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ—Å—Ç–æ—è–Ω–∏—è             | –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ FrankenPHP –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (HTTP 200).                                                                              |

---

## ‚öôÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–µ—Å–æ—á–Ω–∏—Ü—ã

```text
Sandbox/
 ‚îú‚îÄ‚îÄ test1/
 ‚îÇ   ‚îú‚îÄ‚îÄ .env
 ‚îÇ   ‚îú‚îÄ‚îÄ docker-compose.sandbox.yml
 ‚îÇ   ‚îú‚îÄ‚îÄ certs/
 ‚îÇ   ‚îú‚îÄ‚îÄ config/
 ‚îÇ   ‚îú‚îÄ‚îÄ public/
 ‚îÇ   ‚îú‚îÄ‚îÄ src/
 ‚îÇ   ‚îú‚îÄ‚îÄ var/
 ‚îÇ   ‚îú‚îÄ‚îÄ vendor/
 ‚îÇ   ‚îî‚îÄ‚îÄ bin/
 ‚îú‚îÄ‚îÄ test2/
 ‚îÇ   ‚îî‚îÄ‚îÄ ...
```

---

## üöÄ –ó–∞–ø—É—Å–∫ –ø–µ—Å–æ—á–Ω–∏—Ü—ã

```bash
# 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–µ–∫—Ç
git clone ~/PhpstormProjects/TasK ~/PhpstormProjects/Sandbox/test4
cd ~/PhpstormProjects/Sandbox/test4

# 2. –°–æ–±—Ä–∞—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
podman-compose -f docker-compose.sandbox.yml up --build

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å HTTPS-–¥–æ—Å—Ç—É–ø
curl -vk https://test4.task.localhost

# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã Traefik
bin/traefik-check --host test4.task.localhost
```

---

## üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞

| –ö–æ–º–∞–Ω–¥–∞                                 | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                              |
|-----------------------------------------|-----------------------------------------|
| `podman ps`                             | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ |
| `podman exec -it task-test_app_1 sh`    | –ó–∞–π—Ç–∏ –≤–Ω—É—Ç—Ä—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞                 |
| `php bin/console about`                 | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Symfony          |
| `curl -vk https://testN.task.localhost` | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è        |

---

## ‚ö†Ô∏è –ü–æ–¥–≤–æ–¥–Ω—ã–µ –∫–∞–º–Ω–∏

- –ö–∞–∂–¥–∞—è –ø–µ—Å–æ—á–Ω–∏—Ü–∞ –¥–æ–ª–∂–Ω–∞ –∏–º–µ—Ç—å **—É–Ω–∏–∫–∞–ª—å–Ω—ã–π –ø–æ–¥–¥–æ–º–µ–Ω** (`testN.task.localhost`).
- –ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —è–¥—Ä–∞ TasK –Ω—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é –≤—ã–ø–æ–ª–Ω–∏—Ç—å `git pull` –≤ –∫–∞–∂–¥–æ–π –ø–µ—Å–æ—á–Ω–∏—Ü–µ.

---

## üìö –°—Å—ã–ª–∫–∏

- **Symfony 7.3** ‚Äî https://symfony.com/doc/7.3/
- **FrankenPHP Docker** ‚Äî https://frankenphp.dev/docs/docker/
- **Podman Compose** ‚Äî https://docs.podman.io/en/latest/markdown/podman-compose.1.html
- **Traefik v3.1** ‚Äî https://doc.traefik.io/traefik/v3.1/
- **mkcert** ‚Äî https://github.com/FiloSottile/mkcert
